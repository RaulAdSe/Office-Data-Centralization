{% extends "base.html" %}

{% block title %}Edit Values - Office Variable System{% endblock %}

{% block content %}
<h1>Edit Variable Values</h1>
<h2>{{ pe_info[4] }} - {{ pe_info[3] }}</h2>
<div class="element-code">{{ pe_info[6] }}</div>

<form method="POST">
    {% for var in variables %}
    <div class="form-group">
        <label for="var_{{ var.variable_name }}">
            {{ var.variable_name }}
            {% if var.is_required %}<span class="required">*</span>{% endif %}
            {% if var.unit %}({{ var.unit }}){% endif %}
        </label>
        
        {% set current_value = current_values.get(var.variable_name, var.default_value or '') %}
        
        {% if var.variable_type == 'TEXT' %}
        <input type="text" 
               id="var_{{ var.variable_name }}" 
               name="var_{{ var.variable_name }}" 
               value="{{ current_value }}"
               {% if var.is_required %}required{% endif %}>
        {% elif var.variable_type == 'NUMERIC' %}
        <input type="number" 
               step="any"
               id="var_{{ var.variable_name }}" 
               name="var_{{ var.variable_name }}" 
               value="{{ current_value }}"
               {% if var.is_required %}required{% endif %}>
        {% elif var.variable_type == 'DATE' %}
        <input type="date" 
               id="var_{{ var.variable_name }}" 
               name="var_{{ var.variable_name }}" 
               value="{{ current_value }}"
               {% if var.is_required %}required{% endif %}>
        {% else %}
        <input type="text" 
               id="var_{{ var.variable_name }}" 
               name="var_{{ var.variable_name }}" 
               value="{{ current_value }}"
               {% if var.is_required %}required{% endif %}>
        {% endif %}
        
        {% if var.default_value %}
        <small>Default: {{ var.default_value }}</small>
        {% endif %}
    </div>
    {% endfor %}
    
    <button type="submit" class="btn">Save Values</button>
    <a href="/project/{{ pe_info[-1] }}" class="btn" style="background: #666;">Cancel</a>
</form>

<h3>Current Rendered Description:</h3>
<div class="rendered">{{ rendered }}</div>

<script>
// Live preview of rendering (optional enhancement)
// This would require AJAX calls to /api/render endpoint
</script>
{% endblock %}