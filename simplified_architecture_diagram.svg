<svg viewBox="0 0 1400 950" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <marker id="arrowhead-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#9c27b0"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
    </filter>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" font-family="Arial" font-size="24" font-weight="bold" fill="#333" text-anchor="middle">SIMPLIFIED PARAMETRIC ELEMENT SYSTEM</text>
  <text x="700" y="55" font-family="Arial" font-size="14" fill="#666" text-anchor="middle">(No ENUM, No variable_options table)</text>
  
  <!-- Background sections -->
  <rect x="40" y="80" width="1320" height="210" rx="15" fill="#e3f2fd" stroke="#1976d2" stroke-width="3"/>
  <rect x="40" y="310" width="640" height="220" rx="15" fill="#fff8e1" stroke="#f9a825" stroke-width="3"/>
  <rect x="720" y="310" width="640" height="220" rx="15" fill="#e8f5e9" stroke="#388e3c" stroke-width="3"/>
  <rect x="40" y="550" width="1320" height="240" rx="15" fill="#fce4ec" stroke="#c2185b" stroke-width="3"/>
  <rect x="40" y="810" width="1320" height="120" rx="15" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="3"/>
  
  <!-- Section Labels -->
  <text x="60" y="110" font-family="Arial" font-size="20" font-weight="bold" fill="#0d47a1">üìê TEMPLATE LAYER - Define Element Types (One Time Setup)</text>
  <text x="60" y="340" font-family="Arial" font-size="20" font-weight="bold" fill="#f57f17">üìù VERSIONING - Approval Workflow</text>
  <text x="740" y="340" font-family="Arial" font-size="20" font-weight="bold" fill="#1b5e20">üèóÔ∏è PROJECTS - Your Construction Projects</text>
  <text x="60" y="580" font-family="Arial" font-size="20" font-weight="bold" fill="#880e4f">üì¶ INSTANCE LAYER - Specific Elements in Projects</text>
  <text x="60" y="840" font-family="Arial" font-size="20" font-weight="bold" fill="#4a148c">‚öôÔ∏è RENDERING - Auto-Generate Descriptions</text>
  
  <!-- ELEMENTS table -->
  <g filter="url(#shadow)">
    <rect x="80" y="140" width="280" height="130" rx="8" fill="white" stroke="#1976d2" stroke-width="2"/>
    <rect x="80" y="140" width="280" height="40" rx="8" fill="#1976d2"/>
    <text x="220" y="167" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">elements</text>
    <text x="95" y="200" font-family="monospace" font-size="13" fill="#333">element_id (PK)</text>
    <text x="95" y="220" font-family="monospace" font-size="13" fill="#333">element_code</text>
    <text x="95" y="240" font-family="monospace" font-size="13" fill="#333">element_name</text>
    <text x="220" y="260" font-family="Arial" font-size="12" fill="#1976d2" font-style="italic" text-anchor="middle">WALL, BEAM, COLUMN</text>
  </g>
  
  <!-- ELEMENT_VARIABLES table (SIMPLIFIED - no ENUM) -->
  <g filter="url(#shadow)">
    <rect x="420" y="140" width="320" height="130" rx="8" fill="white" stroke="#1976d2" stroke-width="2"/>
    <rect x="420" y="140" width="320" height="40" rx="8" fill="#1976d2"/>
    <text x="580" y="167" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">element_variables</text>
    <text x="435" y="200" font-family="monospace" font-size="13" fill="#333">variable_id (PK)</text>
    <text x="435" y="220" font-family="monospace" font-size="13" fill="#333">variable_name, variable_type</text>
    <text x="435" y="240" font-family="monospace" font-size="13" fill="#333">unit, is_required</text>
    <text x="580" y="260" font-family="Arial" font-size="12" fill="#1976d2" font-style="italic" text-anchor="middle">width(NUMERIC), material(TEXT)</text>
  </g>
  
  <!-- NO variable_options box -->
  <g>
    <rect x="800" y="140" width="280" height="130" rx="8" fill="#ffebee" stroke="#e53935" stroke-width="2" stroke-dasharray="5,5"/>
    <line x1="820" y1="160" x2="1060" y2="250" stroke="#e53935" stroke-width="3"/>
    <line x1="1060" y1="160" x2="820" y2="250" stroke="#e53935" stroke-width="3"/>
    <text x="940" y="200" font-family="Arial" font-size="16" font-weight="bold" fill="#c62828" text-anchor="middle">variable_options</text>
    <text x="940" y="225" font-family="Arial" font-size="14" fill="#c62828" text-anchor="middle">‚ùå REMOVED</text>
    <text x="940" y="245" font-family="Arial" font-size="12" fill="#d32f2f" text-anchor="middle">(No dropdown validation)</text>
  </g>
  
  <!-- DESCRIPTION_VERSIONS table -->
  <g filter="url(#shadow)">
    <rect x="1120" y="140" width="220" height="130" rx="8" fill="white" stroke="#1976d2" stroke-width="2"/>
    <rect x="1120" y="140" width="220" height="40" rx="8" fill="#1976d2"/>
    <text x="1230" y="167" font-family="Arial" font-size="14" font-weight="bold" fill="white" text-anchor="middle">description_versions</text>
    <text x="1135" y="200" font-family="monospace" font-size="12" fill="#333">version_id (PK)</text>
    <text x="1135" y="218" font-family="monospace" font-size="12" fill="#333">description_template</text>
    <text x="1135" y="236" font-family="monospace" font-size="12" fill="#333">state, is_active</text>
    <text x="1230" y="258" font-family="Arial" font-size="10" fill="#666" font-style="italic" text-anchor="middle">"Muro de {material},</text>
    <text x="1230" y="268" font-family="Arial" font-size="10" fill="#666" font-style="italic" text-anchor="middle">{width}√ó{height}mm"</text>
  </g>
  
  <!-- APPROVALS table -->
  <g filter="url(#shadow)">
    <rect x="80" y="370" width="280" height="140" rx="8" fill="white" stroke="#f9a825" stroke-width="2"/>
    <rect x="80" y="370" width="280" height="40" rx="8" fill="#f9a825"/>
    <text x="220" y="397" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">approvals</text>
    <text x="95" y="430" font-family="monospace" font-size="13" fill="#333">approval_id (PK)</text>
    <text x="95" y="450" font-family="monospace" font-size="13" fill="#333">version_id (FK)</text>
    <text x="95" y="470" font-family="monospace" font-size="13" fill="#333">from_state ‚Üí to_state</text>
    <text x="95" y="490" font-family="monospace" font-size="13" fill="#333">approved_by, comments</text>
  </g>
  
  <!-- State flow diagram -->
  <g transform="translate(400, 370)">
    <rect x="0" y="20" width="55" height="35" rx="5" fill="#fff9c4" stroke="#f9a825" stroke-width="2"/>
    <text x="27" y="42" font-family="Arial" font-size="14" font-weight="bold" fill="#333" text-anchor="middle">S0</text>
    
    <line x1="55" y1="37" x2="75" y2="37" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="80" y="20" width="55" height="35" rx="5" fill="#ffe0b2" stroke="#f9a825" stroke-width="2"/>
    <text x="107" y="42" font-family="Arial" font-size="14" font-weight="bold" fill="#333" text-anchor="middle">S1</text>
    
    <line x1="135" y1="37" x2="155" y2="37" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="160" y="20" width="55" height="35" rx="5" fill="#ffcc80" stroke="#f9a825" stroke-width="2"/>
    <text x="187" y="42" font-family="Arial" font-size="14" font-weight="bold" fill="#333" text-anchor="middle">S2</text>
    
    <line x1="215" y1="37" x2="235" y2="37" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="240" y="20" width="55" height="35" rx="5" fill="#a5d6a7" stroke="#388e3c" stroke-width="2"/>
    <text x="267" y="42" font-family="Arial" font-size="14" font-weight="bold" fill="#333" text-anchor="middle">S3</text>
    <text x="267" y="72" font-family="Arial" font-size="11" fill="#388e3c" text-anchor="middle" font-weight="bold">ACTIVE ‚úì</text>
    
    <!-- Rejection path -->
    <line x1="27" y1="55" x2="27" y2="95" stroke="#c62828" stroke-width="1.5"/>
    <line x1="107" y1="55" x2="107" y2="95" stroke="#c62828" stroke-width="1.5"/>
    <line x1="187" y1="55" x2="187" y2="95" stroke="#c62828" stroke-width="1.5"/>
    <rect x="60" y="100" width="100" height="28" rx="5" fill="#ffcdd2" stroke="#c62828" stroke-width="2"/>
    <text x="110" y="119" font-family="Arial" font-size="12" font-weight="bold" fill="#c62828" text-anchor="middle">D (Rejected)</text>
  </g>
  
  <!-- PROJECTS table -->
  <g filter="url(#shadow)">
    <rect x="760" y="370" width="280" height="140" rx="8" fill="white" stroke="#388e3c" stroke-width="2"/>
    <rect x="760" y="370" width="280" height="40" rx="8" fill="#388e3c"/>
    <text x="900" y="397" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">projects</text>
    <text x="775" y="430" font-family="monospace" font-size="13" fill="#333">project_id (PK)</text>
    <text x="775" y="450" font-family="monospace" font-size="13" fill="#333">project_code, project_name</text>
    <text x="775" y="470" font-family="monospace" font-size="13" fill="#333">status, start_date</text>
    <text x="900" y="495" font-family="Arial" font-size="12" fill="#388e3c" font-style="italic" text-anchor="middle">"Torre Barcelona 2024"</text>
  </g>
  
  <!-- Example data box -->
  <g>
    <rect x="1090" y="370" width="250" height="140" rx="8" fill="#e8f5e9" stroke="#388e3c" stroke-width="2"/>
    <text x="1215" y="395" font-family="Arial" font-size="14" font-weight="bold" fill="#2e7d32" text-anchor="middle">Example Project</text>
    <text x="1105" y="420" font-family="Arial" font-size="12" fill="#333">BCN-2024</text>
    <text x="1105" y="440" font-family="Arial" font-size="12" fill="#333">Status: ACTIVE</text>
    <text x="1105" y="460" font-family="Arial" font-size="12" fill="#333">Elements: 47 walls,</text>
    <text x="1105" y="477" font-family="Arial" font-size="12" fill="#333">23 beams, 18 columns</text>
  </g>
  
  <!-- PROJECT_ELEMENTS table -->
  <g filter="url(#shadow)">
    <rect x="80" y="610" width="360" height="160" rx="8" fill="white" stroke="#c2185b" stroke-width="2"/>
    <rect x="80" y="610" width="360" height="40" rx="8" fill="#c2185b"/>
    <text x="260" y="637" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">project_elements</text>
    <text x="95" y="670" font-family="monospace" font-size="13" fill="#333">project_element_id (PK)</text>
    <text x="95" y="690" font-family="monospace" font-size="13" fill="#333">project_id (FK), element_id (FK)</text>
    <text x="95" y="710" font-family="monospace" font-size="13" fill="#c2185b" font-weight="bold">description_version_id (FK) üîí</text>
    <text x="95" y="730" font-family="monospace" font-size="13" fill="#333">instance_code, instance_name</text>
    <text x="260" y="755" font-family="Arial" font-size="11" fill="#666" font-style="italic" text-anchor="middle">WALL-001: "Muro Fachada Norte"</text>
  </g>
  
  <!-- PROJECT_ELEMENT_VALUES table -->
  <g filter="url(#shadow)">
    <rect x="500" y="610" width="380" height="160" rx="8" fill="white" stroke="#c2185b" stroke-width="2"/>
    <rect x="500" y="610" width="380" height="40" rx="8" fill="#c2185b"/>
    <text x="690" y="637" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">project_element_values</text>
    <text x="515" y="670" font-family="monospace" font-size="13" fill="#333">value_id (PK)</text>
    <text x="515" y="690" font-family="monospace" font-size="13" fill="#333">project_element_id (FK)</text>
    <text x="515" y="710" font-family="monospace" font-size="13" fill="#333">variable_id (FK)</text>
    <text x="515" y="730" font-family="monospace" font-size="13" fill="#c2185b" font-weight="bold">value (TEXT - no validation!)</text>
    <text x="690" y="755" font-family="Arial" font-size="11" fill="#666" font-style="italic" text-anchor="middle">width=300, height=2800, material="hormig√≥n"</text>
  </g>
  
  <!-- RENDERED_DESCRIPTIONS table -->
  <g filter="url(#shadow)">
    <rect x="940" y="610" width="400" height="160" rx="8" fill="white" stroke="#c2185b" stroke-width="2"/>
    <rect x="940" y="610" width="400" height="40" rx="8" fill="#c2185b"/>
    <text x="1140" y="637" font-family="Arial" font-size="16" font-weight="bold" fill="white" text-anchor="middle">rendered_descriptions</text>
    <text x="955" y="670" font-family="monospace" font-size="13" fill="#333">render_id (PK)</text>
    <text x="955" y="690" font-family="monospace" font-size="13" fill="#333">project_element_id (FK)</text>
    <text x="955" y="710" font-family="monospace" font-size="13" fill="#333">rendered_text</text>
    <text x="955" y="730" font-family="monospace" font-size="13" fill="#333">is_stale</text>
    <text x="1140" y="755" font-family="Arial" font-size="13" fill="#2e7d32" font-weight="bold" text-anchor="middle">"Muro de hormig√≥n de 300√ó2800mm"</text>
  </g>
  
  <!-- RENDERING ENGINE -->
  <g filter="url(#shadow)">
    <rect x="80" y="850" width="1260" height="60" rx="8" fill="white" stroke="#7b1fa2" stroke-width="2"/>
    <text x="110" y="877" font-family="Arial" font-size="14" font-weight="bold" fill="#7b1fa2">render_description()</text>
    <text x="110" y="898" font-family="Arial" font-size="12" fill="#666">Takes template + values ‚Üí Substitutes {placeholders} ‚Üí Returns final text</text>
    
    <text x="750" y="877" font-family="monospace" font-size="11" fill="#4a148c">"Muro de {material} de {width}√ó{height}mm"</text>
    <text x="950" y="877" font-family="Arial" font-size="12" fill="#666">+</text>
    <text x="980" y="877" font-family="monospace" font-size="11" fill="#4a148c">hormig√≥n, 300, 2800</text>
    <text x="1170" y="877" font-family="Arial" font-size="12" fill="#666">=</text>
    <text x="900" y="898" font-family="Arial" font-size="12" fill="#2e7d32" font-weight="bold">"Muro de hormig√≥n de 300√ó2800mm"</text>
  </g>
  
  <!-- Relationship arrows -->
  <!-- elements -> element_variables -->
  <line x1="360" y1="205" x2="420" y2="205" stroke="#1976d2" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- elements -> description_versions -->
  <path d="M 220 270 L 220 290 L 1230 290 L 1230 270" fill="none" stroke="#1976d2" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- description_versions -> approvals -->
  <path d="M 1120 220 L 380 220 L 380 340 L 220 340 L 220 370" fill="none" stroke="#f9a825" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- projects -> project_elements -->
  <path d="M 900 510 L 900 540 L 260 540 L 260 610" fill="none" stroke="#388e3c" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- project_elements -> project_element_values -->
  <line x1="440" y1="690" x2="500" y2="690" stroke="#c2185b" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- project_element_values -> rendered_descriptions -->
  <line x1="880" y1="690" x2="940" y2="690" stroke="#c2185b" stroke-width="3" marker-end="url(#arrowhead)"/>
  
  <!-- description_versions -> project_elements (locked version) -->
  <path d="M 1230 270 L 1350 270 L 1350 540 L 380 540 L 380 610" fill="none" stroke="#9c27b0" stroke-width="3" stroke-dasharray="8,5" marker-end="url(#arrowhead-purple)"/>
  <text x="1310" y="400" font-family="Arial" font-size="13" fill="#9c27b0" font-weight="bold" transform="rotate(-90, 1310, 400)">VERSION LOCK üîí</text>
  
  <!-- element_variables -> project_element_values -->
  <path d="M 580 270 L 580 600 L 690 600 L 690 610" fill="none" stroke="#1976d2" stroke-width="2" stroke-dasharray="4,3" marker-end="url(#arrowhead)"/>
  
  <!-- Annotations -->
  <g>
    <circle cx="940" cy="205" r="25" fill="#fff59d" stroke="#f57f17" stroke-width="2"/>
    <text x="940" y="213" font-family="Arial" font-size="22" font-weight="bold" fill="#f57f17" text-anchor="middle">9</text>
  </g>
  <text x="940" y="130" font-family="Arial" font-size="14" fill="#e65100" text-anchor="middle" font-weight="bold">9 Tables (vs 10 in full system)</text>
</svg>
